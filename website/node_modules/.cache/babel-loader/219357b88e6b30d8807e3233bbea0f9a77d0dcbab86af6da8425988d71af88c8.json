{"ast":null,"code":"// modified by chris demartini to wrap for npm\n// obtained from https://www.dataplusscience.com/Tabitha.html by Jeffrey Shaffer\n\nvar responsiveVoice = {};\n(function () {\n  var self = this;\n\n  // Our own collection of voices\n  var responsivevoices = [{\n    name: 'UK English Female',\n    voiceIDs: [3, 5, 1, 6, 7, 8]\n  }, {\n    name: 'UK English Male',\n    voiceIDs: [0, 4, 2, 6, 7, 8]\n  }, {\n    name: 'US English Female',\n    voiceIDs: [39, 40, 41, 42, 43, 44]\n  }, {\n    name: 'Spanish Female',\n    voiceIDs: [19, 16, 17, 18, 20, 15]\n  }, {\n    name: 'French Female',\n    voiceIDs: [21, 22, 23, 26]\n  }, {\n    name: 'Deutsch Female',\n    voiceIDs: [27, 28, 29, 30, 31, 32]\n  }, {\n    name: 'Italian Female',\n    voiceIDs: [33, 34, 35, 36, 37, 38]\n  }, {\n    name: 'Hungarian Female',\n    voiceIDs: [9, 10, 11]\n  }, {\n    name: 'Serbian Male',\n    voiceIDs: [12]\n  }, {\n    name: 'Croatian Male',\n    voiceIDs: [13]\n  }, {\n    name: 'Bosnian Male',\n    voiceIDs: [14]\n  }, {\n    name: 'Fallback UK Female',\n    voiceIDs: [8]\n  }];\n\n  //All voices available on every system and device\n  var voicecollection = [{\n    name: 'Google UK English Male'\n  },\n  //0 male uk android/chrome\n  {\n    name: 'Agnes'\n  },\n  //1 female us safari mac\n  {\n    name: 'Daniel Compact'\n  },\n  //2 male us safari mac\n  {\n    name: 'Google UK English Female'\n  },\n  //3 female uk android/chrome\n  {\n    name: 'en-GB',\n    rate: 0.5,\n    pitch: 1\n  },\n  //4 male uk IOS\n  {\n    name: 'en-AU',\n    rate: 0.5,\n    pitch: 1\n  },\n  //5 female english IOS\n  {\n    name: 'inglés Reino Unido'\n  },\n  //6 spanish english android\n  {\n    name: 'English United Kingdom'\n  },\n  //7 english english android\n  {\n    name: 'Fallback en-GB Female',\n    lang: 'en-GB',\n    fallbackvoice: true\n  },\n  //8 fallback english female\n  {\n    name: 'Eszter Compact'\n  },\n  //9 Hungarian mac\n  {\n    name: 'hu-HU',\n    rate: 0.4\n  },\n  //10 Hungarian iOS\n  {\n    name: 'Fallback Hungarian',\n    lang: 'hu',\n    fallbackvoice: true\n  },\n  //11 Hungarian fallback\n  {\n    name: 'Fallback Serbian',\n    lang: 'sr',\n    fallbackvoice: true\n  },\n  //12 Serbian fallback\n  {\n    name: 'Fallback Croatian',\n    lang: 'hr',\n    fallbackvoice: true\n  },\n  //13 Croatian fallback\n  {\n    name: 'Fallback Bosnian',\n    lang: 'bs',\n    fallbackvoice: true\n  },\n  //14 Bosnian fallback\n\n  {\n    name: 'Fallback Spanish',\n    lang: 'es',\n    fallbackvoice: true\n  },\n  //15 Spanish fallback\n  {\n    name: 'Spanish Spain'\n  },\n  //16 female es android/chrome\n  {\n    name: 'español España'\n  },\n  //17 female es android/chrome\n  {\n    name: 'Diego Compact',\n    rate: 0.3\n  },\n  //18 male es mac\n  {\n    name: 'Google Español'\n  },\n  //19 male es chrome\n  {\n    name: 'es-ES',\n    rate: 0.3\n  },\n  //20 male es iOS\n\n  {\n    name: 'Google Français'\n  },\n  //21 FR chrome\n  {\n    name: 'French France'\n  },\n  //22 android/chrome\n  {\n    name: 'francés Francia'\n  },\n  //23 android/chrome\n  {\n    name: 'Virginie Compact',\n    rate: 0.5\n  },\n  //24 mac\n  {\n    name: 'fr-FR',\n    rate: 0.5\n  },\n  //25 iOS\n  {\n    name: 'Fallback French',\n    lang: 'fr',\n    fallbackvoice: true\n  },\n  //26 fallback\n\n  {\n    name: 'Google Deutsch'\n  },\n  //27 DE chrome\n  {\n    name: 'German Germany'\n  },\n  //28 android/chrome\n  {\n    name: 'alemán Alemania'\n  },\n  //29 android/chrome\n  {\n    name: 'Yannick Compact',\n    rate: 0.5\n  },\n  //30 mac\n  {\n    name: 'de-DE',\n    rate: 0.5\n  },\n  //31 iOS\n  {\n    name: 'Fallback Deutsch',\n    lang: 'de',\n    fallbackvoice: true\n  },\n  //32 fallback\n\n  {\n    name: 'Google Italiano'\n  },\n  //33 DE chrome\n  {\n    name: 'Italian Italy'\n  },\n  //34 android/chrome\n  {\n    name: 'italiano Italia'\n  },\n  //35 android/chrome\n  {\n    name: 'Paolo Compact',\n    rate: 0.5\n  },\n  //36 mac\n  {\n    name: 'it-IT',\n    rate: 0.5\n  },\n  //37 iOS\n  {\n    name: 'Fallback Italian',\n    lang: 'it',\n    fallbackvoice: true\n  },\n  //38 fallback\n\n  {\n    name: 'Google US English'\n  },\n  //39 DE chrome\n  {\n    name: 'English United States'\n  },\n  //40 android/chrome\n  {\n    name: 'inglés Estados Unidos'\n  },\n  //41 android/chrome\n  {\n    name: 'Vicki'\n  },\n  //42 mac\n  {\n    name: 'en-US',\n    rate: 0.5\n  },\n  //43 iOS\n  {\n    name: 'Fallback English',\n    lang: 'en-US',\n    fallbackvoice: true\n  } //44 fallback\n  ];\n\n  var systemvoices;\n  var CHARACTER_LIMIT = 100;\n  var VOICESUPPORT_ATTEMPTLIMIT = 5;\n  var voicesupport_attempts = 0;\n  var fallbackMode = false;\n  this.fallback_playing = false;\n  this.fallback_parts = null;\n  this.fallback_part_index = 0;\n  this.fallback_audio = null;\n  self.msgparameters = null;\n  self.timeoutId = null;\n  self.WORDS_PER_MINUTE = 130;\n  self.debug = false;\n\n  //Wait until system voices are ready and trigger the event OnVoiceReady\n  if (typeof speechSynthesis != 'undefined') {\n    speechSynthesis.onvoiceschanged = function () {\n      systemvoices = window.speechSynthesis.getVoices();\n      if (self.OnVoiceReady != null) {\n        self.OnVoiceReady.call();\n      }\n    };\n  }\n  this.default_rv = responsivevoices[0];\n  this.OnVoiceReady = null;\n\n  //We should use jQuery if it's available\n  if (typeof $ === 'undefined') {\n    document.addEventListener('DOMContentLoaded', function () {\n      init();\n    });\n  } else {\n    $(document).ready(function () {\n      init();\n    });\n  }\n  self.log = function (log) {\n    if (self.debug) {\n      console.log(log);\n    }\n  };\n  function init() {\n    if (typeof speechSynthesis === 'undefined') {\n      enableFallbackMode();\n    } else {\n      //Waiting a few ms before calling getVoices() fixes some issues with safari on IOS as well as Chrome\n      setTimeout(function () {\n        var gsvinterval = setInterval(function () {\n          var v = window.speechSynthesis.getVoices();\n          if (v.length == 0 && (systemvoices == null || systemvoices.length == 0)) {\n            console.log('Voice support NOT ready');\n            voicesupport_attempts++;\n            if (voicesupport_attempts > VOICESUPPORT_ATTEMPTLIMIT) {\n              //We don't support voices. Using fallback\n\n              clearInterval(gsvinterval);\n              enableFallbackMode();\n            }\n          } else {\n            console.log('Voice support ready');\n            clearInterval(gsvinterval);\n            systemvoices = v;\n            mapRVs();\n            if (self.OnVoiceReady != null) self.OnVoiceReady.call();\n          }\n        }, 100);\n      }, 100);\n    }\n  }\n  function enableFallbackMode() {\n    fallbackMode = true;\n    console.log('Voice not supported. Using fallback mode');\n    mapRVs();\n    if (self.OnVoiceReady != null) self.OnVoiceReady.call();\n  }\n  this.getVoices = function () {\n    //Create voices array\n\n    var v = [];\n    for (var i = 0; i < responsivevoices.length; i++) {\n      v.push({\n        name: responsivevoices[i].name\n      });\n    }\n    return v;\n  };\n  this.speak = function (text, voicename, parameters) {\n    //console.log(text, voicename, parameters);\n    //Support for multipart text (there is a limit on characters)\n    text = text.replace(/[\\\"\\`]/gm, \"'\");\n    self.msgparameters = parameters || {};\n    self.msgtext = text;\n    self.msgvoicename = voicename;\n    self.onstartFired = false;\n    var multipartText = [];\n    if (text.length > CHARACTER_LIMIT) {\n      var tmptxt = text;\n      while (tmptxt.length > CHARACTER_LIMIT) {\n        //Split by common phrase delimiters\n        var p = tmptxt.search(/[:!?.;]+/);\n        var part = '';\n\n        //Coludn't split by priority characters, try commas\n        if (p == -1 || p >= CHARACTER_LIMIT) {\n          p = tmptxt.search(/[,]+/);\n        }\n\n        //Couldn't split by normal characters, then we use spaces\n        if (p == -1 || p >= CHARACTER_LIMIT) {\n          var words = tmptxt.split(' ');\n          for (var i = 0; i < words.length; i++) {\n            if (part.length + words[i].length + 1 > CHARACTER_LIMIT) break;\n            part += (i != 0 ? ' ' : '') + words[i];\n          }\n        } else {\n          part = tmptxt.substr(0, p + 1);\n        }\n        tmptxt = tmptxt.substr(part.length, tmptxt.length - part.length);\n        multipartText.push(part);\n        //console.log(part.length + \" - \" + part);\n      }\n\n      //Add the remaining text\n      if (tmptxt.length > 0) {\n        multipartText.push(tmptxt);\n      }\n    } else {\n      //Small text\n      multipartText.push(text);\n    }\n\n    //Find system voice that matches voice name\n    var rv;\n    if (voicename == null) {\n      rv = self.default_rv;\n    } else {\n      rv = getResponsiveVoice(voicename);\n    }\n    var profile = {};\n\n    //Map was done so no need to look for the mapped voice\n    if (rv.mappedProfile != null) {\n      profile = rv.mappedProfile;\n    } else {\n      profile.systemvoice = getMatchedVoice(rv);\n      profile.collectionvoice = {};\n      if (profile.systemvoice == null) {\n        console.log('ERROR: No voice found for: ' + voicename);\n        return;\n      }\n    }\n    self.msgprofile = profile;\n    if (profile.collectionvoice.fallbackvoice == true) {\n      fallbackMode = true;\n      self.fallback_parts = [];\n    } else {\n      fallbackMode = false;\n    }\n\n    //Play multipart text\n    for (var i = 0; i < multipartText.length; i++) {\n      if (!fallbackMode) {\n        //Use SpeechSynthesis\n\n        //Create msg object\n        var msg = new SpeechSynthesisUtterance();\n        msg.voice = profile.systemvoice;\n        msg.voiceURI = profile.systemvoice.voiceURI;\n        msg.volume = profile.collectionvoice.volume || profile.systemvoice.volume || 1; // 0 to 1\n        msg.rate = profile.collectionvoice.rate || profile.systemvoice.rate || 1; // 0.1 to 10\n        msg.pitch = profile.collectionvoice.pitch || profile.systemvoice.pitch || 1; //0 to 2*/\n        msg.text = multipartText[i];\n        msg.lang = profile.collectionvoice.lang || profile.systemvoice.lang;\n        //console.log(msg);\n\n        if (i == 0) {\n          msg.onstart = self.speech_onstart;\n        }\n        self.msgparameters.onendcalled = false;\n        if (parameters != null) {\n          if (i < multipartText.length - 1 && multipartText.length > 1) {\n            // don't need this\n            // msg.onend = self.onPartEnd;\n            // if (msg.hasOwnProperty(\"addEventListener\"))\n            // \tmsg.addEventListener('end',self.onPartEnd);\n          } else {\n            msg.onend = self.speech_onend;\n            if (msg.hasOwnProperty(\"addEventListener\")) msg.addEventListener('end', self.speech_onend);\n          }\n          msg.onerror = parameters.onerror || function (e) {\n            self.log('RV: Unknow Error');\n            self.log(e);\n          };\n        } else {\n          self.log('No Params received for current Utterance');\n          msg.onend = self.speech_onend;\n          msg.onerror = function (e) {\n            self.log('RV: Unknow Error');\n            self.log(e);\n          };\n        }\n        self.cancelled = false;\n        speechSynthesis.speak(msg);\n      } else {\n        var url = 'http://www.corsproxy.com/translate.google.com/translate_tts?ie=UTF-8&q=' + multipartText[i] + '&tl=' + profile.collectionvoice.lang || profile.systemvoice.lang || 'en-US';\n        var audio = new Audio(url);\n        audio.playbackRate = 1;\n        audio.preload = 'auto';\n        audio.volume = profile.collectionvoice.volume || profile.systemvoice.volume || 1; // 0 to 1;\n        self.fallback_parts.push(audio);\n      }\n    }\n    if (fallbackMode) self.fallback_startPlaying();\n  };\n  this.fallback_startPlaying = function () {\n    //console.log('start playing');\n\n    self.fallback_part_index = 0;\n\n    //console.log(self.fallback_parts);\n\n    self.fallback_finishedplaying();\n  };\n  this.fallback_finishedplaying = function (e) {\n    //console.log('chunk ended');\n    self.fallback_audio = self.fallback_parts[self.fallback_part_index];\n    //console.log(self.fallback_audio);\n\n    //self.fallback_audio.addEventListener('error', function(e){ console.log('error'); console.log(e)});\n    //self.fallback_audio.addEventListener('progress', function(e){ console.log('progress'); this.play();});\n    //self.fallback_audio.addEventListener('loadstart', function(e){ console.log('loadstart'); console.log(e)});\n    //self.fallback_audio.load();\n    self.fallback_audio.play();\n\n    //audio.addEventListener('play', utterance.onstart);\n\n    self.fallback_part_index++;\n    if (self.fallback_part_index < self.fallback_parts.length) {\n      self.fallback_audio.addEventListener('ended', self.fallback_finishedplaying);\n    }\n  };\n  this.cancel = function () {\n    self.checkAndCancelTimeout();\n    if (fallbackMode) self.fallback_audio.pause();else self.cancelled = true;\n    speechSynthesis.cancel();\n  };\n  this.voiceSupport = function () {\n    return 'speechSynthesis' in window;\n  };\n  self.numToWords = function (n) {\n    var _slicedToArray = function () {\n      function sliceIterator(arr, i) {\n        var _arr = [];\n        var _n = true;\n        var _d = false;\n        var _e = undefined;\n        try {\n          for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n            _arr.push(_s.value);\n            if (i && _arr.length === i) break;\n          }\n        } catch (err) {\n          _d = true;\n          _e = err;\n        } finally {\n          try {\n            if (!_n && _i[\"return\"]) _i[\"return\"]();\n          } finally {\n            if (_d) throw _e;\n          }\n        }\n        return _arr;\n      }\n      return function (arr, i) {\n        if (Array.isArray(arr)) {\n          return arr;\n        } else if (Symbol.iterator in Object(arr)) {\n          return sliceIterator(arr, i);\n        } else {\n          throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n        }\n      };\n    }();\n    function _toConsumableArray(arr) {\n      if (Array.isArray(arr)) {\n        for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n          arr2[i] = arr[i];\n        }\n        return arr2;\n      } else {\n        return Array.from(arr);\n      }\n    }\n    var arr = function arr(x) {\n      return Array.from(x);\n    };\n    var num = function num(x) {\n      return Number(x) || 0;\n    };\n    var isEmpty = function isEmpty(xs) {\n      return xs.length === 0;\n    };\n    var take = function take(n) {\n      return function (xs) {\n        return xs.slice(0, n);\n      };\n    };\n    var drop = function drop(n) {\n      return function (xs) {\n        return xs.slice(n);\n      };\n    };\n    var reverse = function reverse(xs) {\n      return xs.slice(0).reverse();\n    };\n    var comp = function comp(f) {\n      return function (g) {\n        return function (x) {\n          return f(g(x));\n        };\n      };\n    };\n    var not = function not(x) {\n      return !x;\n    };\n    var chunk = function chunk(n) {\n      return function (xs) {\n        return isEmpty(xs) ? [] : [take(n)(xs)].concat(_toConsumableArray(chunk(n)(drop(n)(xs))));\n      };\n    };\n    var a = ['', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen', 'sixteen', 'seventeen', 'eighteen', 'nineteen'];\n    var b = ['', '', 'twenty', 'thirty', 'forty', 'fifty', 'sixty', 'seventy', 'eighty', 'ninety'];\n    var g = ['', 'thousand', 'million', 'billion', 'trillion', 'quadrillion', 'quintillion', 'sextillion', 'septillion', 'octillion', 'nonillion'];\n\n    // this part is really nasty still\n    // it might edit this again later to show how Monoids could fix this up\n    var makeGroup = function makeGroup(_ref) {\n      var _ref2 = _slicedToArray(_ref, 3);\n      var ones = _ref2[0];\n      var tens = _ref2[1];\n      var huns = _ref2[2];\n      return [num(huns) === 0 ? '' : a[huns] + ' hundred ', num(ones) === 0 ? b[tens] : b[tens] && b[tens] + ' ' || '', a[tens + ones] || a[ones]].join('');\n    };\n    var thousand = function thousand(group, i) {\n      return group === '' ? group : group + ' ' + g[i];\n    };\n    if (typeof n === 'number') return self.numToWords(String(n));else if (n === '0') return 'zero';else return comp(chunk(3))(reverse)(arr(n)).map(makeGroup).map(thousand).filter(comp(not)(isEmpty)).reverse().join(' ').trim();\n  };\n  self.getWords = function (text) {\n    var words = text.split(/(\\s*[\\s,]\\s*|\\?|;|:|\\.|\\(|\\)|!)/),\n      match;\n    words = words.filter(function (str) {\n      return /[^\\s]/.test(str);\n    });\n\n    //find numbers, translate them to text, push as words\n    for (var i = 0; i < words.length; i++) {\n      if ((match = words[i].toString().match(/\\d+/)) != null) {\n        words.splice(i, 1);\n        self.numToWords(+match[0]).split(/\\s+/).map(function (word) {\n          words.push(word);\n        });\n      }\n    }\n    return words;\n  };\n  self.getEstimatedTimeLength = function (text, multiplier) {\n    var words = self.getWords(text),\n      charsCount = 0,\n      base = fallbackMode ? 1300 : 700,\n      multiplier = multiplier || 1 /*, minWordLengthInText = 0, maxWordLengthInText = 0*/;\n\n    words.map(function (word, i) {\n      charsCount += (word.toString().match(/[^ ]/igm) || word).length;\n\n      /*self.log(minWordLengthInText, maxWordLengthInText);\r\n      if (minWordLengthInText > 0 && minWordLengthInText > word.length) {\r\n      minWordLengthInText = word.length;\r\n      } else if (maxWordLengthInText > 0 && maxWordLengthInText < word.length) {\r\n      maxWordLengthInText = word.length;\r\n      } else if (minWordLengthInText == 0 && maxWordLengthInText == 0) {\r\n      minWordLengthInText = maxWordLengthInText = word.length;\r\n      }*/\n    });\n\n    //self.log(\"Words: [\" + words + \"], charsCount: \" + charsCount);\n\n    var wordsCount = words.length;\n    //var avgWordLengthInText = (minWordLengthInText + maxWordLengthInText) / 2;\n\n    //self.log(minWordLengthInText, maxWordLengthInText, avgWordLengthInText);\n\n    //var wlf = (charsCount/wordsCount) / avgWordLengthInText * 5.1; //word length factor: 5.1 is the average word length in english.\n\n    var estimatedLength = multiplier * 1000 * (60 / self.WORDS_PER_MINUTE) * wordsCount /** wlf*/;\n\n    if (wordsCount < 5) {\n      estimatedLength = multiplier * (base + charsCount * 50);\n    }\n    self.log(\"Estimated time length: \" + estimatedLength + \" ms, words: [\" + words + \"], charsCount: \" + charsCount);\n    return estimatedLength;\n  };\n  self.startTimeout = function (text, callback) {\n    //if (self.iOS) {\n    //   multiplier = 0.5;\n    //}\n    var multiplier = self.msgprofile.collectionvoice.timerSpeed;\n    if (self.msgprofile.collectionvoice.timerSpeed == null) multiplier = 1;\n\n    //self.log(self.msgprofile.collectionvoice.name);\n    if (multiplier <= 0) return;\n    self.timeoutId = setTimeout(callback, self.getEstimatedTimeLength(text, multiplier));\n    //console.log(self.getEstimatedTimeLength(text, multiplier),callback);\n    self.log(\"Timeout ID: \" + self.timeoutId, text);\n  };\n  self.isPlaying = function () {\n    if (self.fallbackMode) {\n      return self.fallback_audio != null && !self.fallback_audio.ended && !self.fallback_audio.paused;\n    } else {\n      return speechSynthesis.speaking;\n    }\n  };\n  self.checkAndCancelTimeout = function () {\n    if (self.timeoutId != null) {\n      //self.log(\"Timeout \" + self.timeoutId + \" cancelled\");\n      clearTimeout(self.timeoutId);\n      self.timeoutId = null;\n    }\n  };\n  self.speech_timedout = function () {\n    //self.log(\"Speech cancelled: Timeout \" + self.timeoutId + \" ended\");\n    self.cancel();\n    self.cancelled = false;\n    //if (!self.iOS) //On iOS, cancel calls msg.onend\n    self.speech_onend();\n  };\n  self.speech_onstart = function () {\n    //Start can be triggered after onboundary!\n    //if (self.onstartFired) return\n\n    self.onstartFired = true;\n    //if (!self.iOS)\n    self.log(\"Speech start\");\n    if (!self.fallbackMode) {\n      self.startTimeout(self.msgtext, self.speech_timedout);\n    }\n    self.msgparameters.onendcalled = false;\n    if (self.msgparameters != null && self.msgparameters.onstart != null) {\n      self.msgparameters.onstart();\n    }\n  };\n  self.speech_onend = function () {\n    self.checkAndCancelTimeout();\n\n    //Avoid this being automatically called just after calling speechSynthesis.cancel\n    if (self.cancelled === true) {\n      self.cancelled = false;\n      return;\n    }\n    self.log(\"on end fired\");\n    if (self.msgparameters != null && self.msgparameters.onend != null && self.msgparameters.onendcalled != true) {\n      self.log(\"Speech on end called  -\" + self.msgtext);\n      self.msgparameters.onendcalled = true;\n      if (!self.isPlaying()) {\n        self.msgparameters.onend();\n      } else {\n        console.log('still talking');\n      }\n    }\n  };\n  this.OnFinishedPlaying = function (event) {\n    //console.log(parameters);\n    if (self.msgparameters != null) {\n      if (self.msgparameters.onend != null) {\n        self.msgparameters.onend();\n      }\n    }\n  };\n\n  //Set default voice to use when no voice name is supplied to speak()\n  this.setDefaultVoice = function (voicename) {\n    var vr = getResponsiveVoice(voicename);\n    if (vr != null) {\n      self.default_vr = vr;\n    }\n  };\n\n  //Map responsivevoices to system voices\n  function mapRVs() {\n    for (var i = 0; i < responsivevoices.length; i++) {\n      var rv = responsivevoices[i];\n      for (var j = 0; j < rv.voiceIDs.length; j++) {\n        var vcoll = voicecollection[rv.voiceIDs[j]];\n        if (vcoll.fallbackvoice != true) {\n          // vcoll.fallbackvoice would be null instead of false\n\n          // Look on system voices\n          var v = getSystemVoice(vcoll.name);\n          if (v != null) {\n            rv.mappedProfile = {\n              systemvoice: v,\n              collectionvoice: vcoll\n            };\n            console.log(\"Mapped \" + rv.name + \" to \" + v.name);\n            break;\n          }\n        } else {\n          //Pick the fallback voice\n          rv.mappedProfile = {\n            systemvoice: {},\n            collectionvoice: vcoll\n          };\n          console.log(\"Mapped \" + rv.name + \" to \" + vcoll.lang + \" fallback voice\");\n          break;\n        }\n      }\n    }\n  }\n\n  //Look for the voice in the system that matches the one in our collection\n  function getMatchedVoice(rv) {\n    for (var i = 0; i < rv.voiceIDs.length; i++) {\n      var v = getSystemVoice(voicecollection[rv.voiceIDs[i]].name);\n      if (v != null) return v;\n    }\n    return null;\n  }\n  function getSystemVoice(name) {\n    if (typeof systemvoices === 'undefined') return null;\n    for (var i = 0; i < systemvoices.length; i++) {\n      if (systemvoices[i].name == name) return systemvoices[i];\n    }\n    return null;\n  }\n  function getResponsiveVoice(name) {\n    for (var i = 0; i < responsivevoices.length; i++) {\n      if (responsivevoices[i].name == name) {\n        return responsivevoices[i];\n      }\n    }\n    return null;\n  }\n})();\nmodule.exports = responsiveVoice;","map":{"version":3,"names":["responsiveVoice","self","responsivevoices","name","voiceIDs","voicecollection","rate","pitch","lang","fallbackvoice","systemvoices","CHARACTER_LIMIT","VOICESUPPORT_ATTEMPTLIMIT","voicesupport_attempts","fallbackMode","fallback_playing","fallback_parts","fallback_part_index","fallback_audio","msgparameters","timeoutId","WORDS_PER_MINUTE","debug","speechSynthesis","onvoiceschanged","window","getVoices","OnVoiceReady","call","default_rv","$","document","addEventListener","init","ready","log","console","enableFallbackMode","setTimeout","gsvinterval","setInterval","v","length","clearInterval","mapRVs","i","push","speak","text","voicename","parameters","replace","msgtext","msgvoicename","onstartFired","multipartText","tmptxt","p","search","part","words","split","substr","rv","getResponsiveVoice","profile","mappedProfile","systemvoice","getMatchedVoice","collectionvoice","msgprofile","msg","SpeechSynthesisUtterance","voice","voiceURI","volume","onstart","speech_onstart","onendcalled","onend","speech_onend","hasOwnProperty","onerror","e","cancelled","url","audio","Audio","playbackRate","preload","fallback_startPlaying","fallback_finishedplaying","play","cancel","checkAndCancelTimeout","pause","voiceSupport","numToWords","n","_slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","undefined","_i","Symbol","iterator","_s","next","done","value","err","Array","isArray","Object","TypeError","_toConsumableArray","arr2","from","x","num","Number","isEmpty","xs","take","slice","drop","reverse","comp","f","g","not","chunk","concat","a","b","makeGroup","_ref","_ref2","ones","tens","huns","join","thousand","group","String","map","filter","trim","getWords","match","str","test","toString","splice","word","getEstimatedTimeLength","multiplier","charsCount","base","wordsCount","estimatedLength","startTimeout","callback","timerSpeed","isPlaying","ended","paused","speaking","clearTimeout","speech_timedout","OnFinishedPlaying","event","setDefaultVoice","vr","default_vr","j","vcoll","getSystemVoice","module","exports"],"sources":["C:/Users/Xavier/Desktop/JAVA PROJECT/frontend/website/node_modules/responsivevoice/responsivevoice.js"],"sourcesContent":["// modified by chris demartini to wrap for npm\r\n// obtained from https://www.dataplusscience.com/Tabitha.html by Jeffrey Shaffer\r\n\r\nvar responsiveVoice = {};\r\n\r\n(function() {\r\n\r\n\tvar self = this;\r\n\r\n\r\n\t// Our own collection of voices\r\n\tvar responsivevoices = [\r\n\t\t{name: 'UK English Female', \t\tvoiceIDs: [3,5,1,6,7,8] },\r\n\t\t{name: 'UK English Male', \t\t\tvoiceIDs: [0,4,2,6,7,8] },\r\n\t\t{name: 'US English Female',\t\t\tvoiceIDs: [39,40,41,42,43,44] },\r\n\t\t{name: 'Spanish Female',\t\t\tvoiceIDs: [19,16,17,18,20,15] },\r\n\t\t{name: 'French Female',\t\t\t\tvoiceIDs: [21,22,23,26] },\r\n\t\t{name: 'Deutsch Female',\t\t\tvoiceIDs: [27,28,29,30,31,32] },\r\n\t\t{name: 'Italian Female',\t\t\tvoiceIDs: [33,34,35,36,37,38] },\r\n\t\t{name: 'Hungarian Female',\t\t\tvoiceIDs: [9,10,11] },\r\n\t\t{name: 'Serbian Male',\t\t\t\tvoiceIDs: [12] },\r\n\t\t{name: 'Croatian Male',\t\t\t\tvoiceIDs: [13] },\r\n\t\t{name: 'Bosnian Male',\t\t\t\tvoiceIDs: [14] },\r\n\t\t{name: 'Fallback UK Female',\t \tvoiceIDs: [8] }\r\n\r\n\t];\r\n\r\n\t//All voices available on every system and device\r\n\tvar voicecollection = [\r\n\t\t{name: 'Google UK English Male'},\t\t\t\t\t\t\t\t\t\t//0 male uk android/chrome\r\n\t\t{name: 'Agnes'},\t\t\t\t\t\t\t\t\t\t\t\t\t\t//1 female us safari mac\r\n\t\t{name: 'Daniel Compact'},\t\t\t\t\t\t\t\t\t\t\t\t//2 male us safari mac\r\n\t\t{name: 'Google UK English Female'},\t\t\t\t\t\t\t\t\t\t//3 female uk android/chrome\r\n\t\t{name: 'en-GB', rate: 0.5, pitch: 1}, \t\t\t\t\t\t\t\t\t//4 male uk IOS\r\n\t\t{name: 'en-AU', rate: 0.5, pitch: 1},\t\t\t\t\t\t\t\t\t//5 female english IOS\r\n\t\t{name: 'inglés Reino Unido'},\t\t\t\t\t\t\t\t\t\t\t//6 spanish english android\r\n\t\t{name: 'English United Kingdom'},\t\t\t\t\t\t\t\t\t\t//7 english english android\r\n\t\t{name: 'Fallback en-GB Female', lang: 'en-GB', \tfallbackvoice: true},\t//8 fallback english female\r\n\t\t{name: 'Eszter Compact'},\t\t\t\t\t\t\t\t\t\t\t\t//9 Hungarian mac\r\n\t\t{name: 'hu-HU', rate: 0.4},\t\t\t\t\t\t\t\t\t\t\t\t\t\t//10 Hungarian iOS\r\n\t\t{name: 'Fallback Hungarian', \tlang: 'hu', \tfallbackvoice:true},\t//11 Hungarian fallback\r\n\t\t{name: 'Fallback Serbian', \t\tlang: 'sr', \tfallbackvoice:true},\t//12 Serbian fallback\r\n\t\t{name: 'Fallback Croatian',\t\tlang: 'hr', \tfallbackvoice:true},\t//13 Croatian fallback\r\n\t\t{name: 'Fallback Bosnian',\t\tlang: 'bs', \tfallbackvoice:true},\t//14 Bosnian fallback\r\n\r\n\t\t{name: 'Fallback Spanish',\t\tlang: 'es', \tfallbackvoice:true},\t//15 Spanish fallback\r\n\t\t{name: 'Spanish Spain'},\t\t\t\t\t\t\t\t\t\t\t\t//16 female es android/chrome\r\n\t\t{name: 'español España'},\t\t\t\t\t\t\t\t\t\t\t\t//17 female es android/chrome\r\n\t\t{name: 'Diego Compact', rate: 0.3},\t\t\t\t\t\t\t\t\t\t//18 male es mac\r\n\t\t{name: 'Google Español'},\t\t\t\t\t\t\t\t\t\t\t\t//19 male es chrome\r\n\t\t{name: 'es-ES', rate: 0.3},\t\t\t\t\t\t\t\t\t\t\t\t//20 male es iOS\r\n\r\n\t\t{name: 'Google Français'},\t\t\t\t\t\t\t\t\t\t\t\t//21 FR chrome\r\n\t\t{name: 'French France'},\t\t\t\t\t\t\t\t\t\t\t\t//22 android/chrome\r\n\t\t{name: 'francés Francia'},\t\t\t\t\t\t\t\t\t\t\t\t//23 android/chrome\r\n\t\t{name: 'Virginie Compact', rate: 0.5},\t\t\t\t\t\t\t\t\t//24 mac\r\n\t\t{name: 'fr-FR', rate: 0.5},\t\t\t\t\t\t\t\t\t\t\t\t//25 iOS\r\n\t\t{name: 'Fallback French',\t\tlang: 'fr', \tfallbackvoice:true},\t//26 fallback\r\n\r\n\t\t{name: 'Google Deutsch'},\t\t\t\t\t\t\t\t\t\t\t\t//27 DE chrome\r\n\t\t{name: 'German Germany'},\t\t\t\t\t\t\t\t\t\t\t\t//28 android/chrome\r\n\t\t{name: 'alemán Alemania'},\t\t\t\t\t\t\t\t\t\t\t\t//29 android/chrome\r\n\t\t{name: 'Yannick Compact', rate: 0.5},\t\t\t\t\t\t\t\t\t//30 mac\r\n\t\t{name: 'de-DE', rate: 0.5},\t\t\t\t\t\t\t\t\t\t\t\t//31 iOS\r\n\t\t{name: 'Fallback Deutsch',\t\tlang: 'de', \tfallbackvoice:true},\t//32 fallback\r\n\r\n\t\t{name: 'Google Italiano'},\t\t\t\t\t\t\t\t\t\t\t\t//33 DE chrome\r\n\t\t{name: 'Italian Italy'},\t\t\t\t\t\t\t\t\t\t\t\t//34 android/chrome\r\n\t\t{name: 'italiano Italia'},\t\t\t\t\t\t\t\t\t\t\t\t//35 android/chrome\r\n\t\t{name: 'Paolo Compact', rate: 0.5},\t\t\t\t\t\t\t\t\t\t//36 mac\r\n\t\t{name: 'it-IT', rate: 0.5},\t\t\t\t\t\t\t\t\t\t\t\t//37 iOS\r\n\t\t{name: 'Fallback Italian',\t\tlang: 'it', \tfallbackvoice:true},\t//38 fallback\r\n\r\n\t\t{name: 'Google US English'},\t\t\t\t\t\t\t\t\t\t\t//39 DE chrome\r\n\t\t{name: 'English United States'},\t\t\t\t\t\t\t\t\t\t//40 android/chrome\r\n\t\t{name: 'inglés Estados Unidos'},\t\t\t\t\t\t\t\t\t\t//41 android/chrome\r\n\t\t{name: 'Vicki'},\t\t\t\t\t\t\t\t\t\t\t\t\t\t//42 mac\r\n\t\t{name: 'en-US', rate: 0.5},\t\t\t\t\t\t\t\t\t\t\t\t//43 iOS\r\n\t\t{name: 'Fallback English',\t\tlang: 'en-US', \tfallbackvoice:true},\t//44 fallback\r\n\r\n\t];\r\n\r\n\tvar systemvoices;\r\n\r\n\tvar CHARACTER_LIMIT = 100;\r\n\tvar VOICESUPPORT_ATTEMPTLIMIT = 5;\r\n\tvar voicesupport_attempts = 0;\r\n\tvar fallbackMode = false;\r\n\r\n\tthis.fallback_playing = false;\r\n\tthis.fallback_parts = null;\r\n\tthis.fallback_part_index = 0;\r\n\tthis.fallback_audio = null;\r\n\tself.msgparameters = null;\r\n\tself.timeoutId = null;\r\n\tself.WORDS_PER_MINUTE = 130;\r\n\tself.debug = false;\r\n\r\n\t//Wait until system voices are ready and trigger the event OnVoiceReady\r\n\tif (typeof speechSynthesis != 'undefined') {\r\n\t\tspeechSynthesis.onvoiceschanged = function() {\r\n\r\n\t\t\tsystemvoices = window.speechSynthesis.getVoices();\r\n\r\n\t\t\tif (self.OnVoiceReady!=null) {\r\n\t\t\t\tself.OnVoiceReady.call();\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tthis.default_rv = responsivevoices[0];\r\n\r\n\r\n\r\n\tthis.OnVoiceReady = null;\r\n\r\n\r\n\t//We should use jQuery if it's available\r\n\tif (typeof $ === 'undefined') {\r\n\t\tdocument.addEventListener('DOMContentLoaded',function(){\r\n\t\t\tinit();\r\n\t\t});\r\n\t}else{\r\n\r\n\t\t$(document).ready(function() {\r\n\t\t\tinit();\r\n\t\t});\r\n\t}\r\n\r\n\tself.log = function (log) {\r\n\t\tif (self.debug) {\r\n\t\t\t\tconsole.log(log);\r\n\t\t}\r\n\t};\r\n\r\n\r\n\tfunction init() {\r\n\r\n\r\n\t\tif (typeof speechSynthesis === 'undefined') {\r\n\r\n\t\t\tenableFallbackMode();\r\n\r\n\t\t} else {\r\n\r\n\r\n\t\t\t//Waiting a few ms before calling getVoices() fixes some issues with safari on IOS as well as Chrome\r\n\t\t\tsetTimeout(function(){\r\n\t\t\t\tvar gsvinterval = setInterval(function() {\r\n\r\n\t\t\t\t\tvar v = window.speechSynthesis.getVoices();\r\n\r\n\t\t\t\t\tif (v.length==0 && (systemvoices==null || systemvoices.length==0)) {\r\n\t\t\t\t\t\tconsole.log('Voice support NOT ready');\r\n\r\n\t\t\t\t\t\tvoicesupport_attempts++;\r\n\t\t\t\t\t\tif (voicesupport_attempts > VOICESUPPORT_ATTEMPTLIMIT) {\r\n\t\t\t\t\t\t\t//We don't support voices. Using fallback\r\n\r\n\t\t\t\t\t\t\tclearInterval(gsvinterval);\r\n\r\n\t\t\t\t\t\t\tenableFallbackMode();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}else{\r\n\r\n\t\t\t\t\t\tconsole.log('Voice support ready');\r\n\r\n\t\t\t\t\t\tclearInterval(gsvinterval);\r\n\r\n\t\t\t\t\t\tsystemvoices = v;\r\n\r\n\t\t\t\t\t\tmapRVs();\r\n\r\n\t\t\t\t\t\tif (self.OnVoiceReady!=null)\r\n\t\t\t\t\t\t\tself.OnVoiceReady.call();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},100);\r\n\t\t\t},100);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction enableFallbackMode() {\r\n\r\n\t\tfallbackMode = true;\r\n\t\tconsole.log('Voice not supported. Using fallback mode');\r\n\r\n\t\tmapRVs();\r\n\r\n\t\tif (self.OnVoiceReady!=null)\r\n\t\t\tself.OnVoiceReady.call();\r\n\r\n\r\n\t}\r\n\r\n\r\n\tthis.getVoices = function() {\r\n\r\n\t\t//Create voices array\r\n\r\n\t\tvar v = [];\r\n\r\n\t\tfor (var i=0; i<responsivevoices.length; i++) {\r\n\t\t\tv.push( { name: responsivevoices[i].name });\r\n\t\t}\r\n\r\n\t\treturn v;\r\n\r\n\t}\r\n\r\n\r\n\tthis.speak = function(text, voicename, parameters) {\r\n\r\n\t\t//console.log(text, voicename, parameters);\r\n\t\t//Support for multipart text (there is a limit on characters)\r\n\t\ttext = text.replace(/[\\\"\\`]/gm,\"'\");\r\n\r\n\t\tself.msgparameters = parameters ||  {};\r\n\t\tself.msgtext = text;\r\n\t\tself.msgvoicename = voicename;\r\n\r\n\t\tself.onstartFired = false;\r\n\r\n\t\tvar multipartText = [];\r\n\r\n\t\tif (text.length>CHARACTER_LIMIT) {\r\n\r\n\t\t\tvar tmptxt = text;\r\n\r\n\t\t\twhile(tmptxt.length>CHARACTER_LIMIT) {\r\n\r\n\t\t\t\t//Split by common phrase delimiters\r\n\t\t\t\tvar p = tmptxt.search(/[:!?.;]+/);\r\n\t\t\t\tvar part = '';\r\n\r\n\t\t\t\t//Coludn't split by priority characters, try commas\r\n\t\t\t\tif (p==-1 || p>=CHARACTER_LIMIT ) {\r\n\t\t\t\t\tp = tmptxt.search(/[,]+/);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//Couldn't split by normal characters, then we use spaces\r\n\t\t\t\tif (p==-1 || p>=CHARACTER_LIMIT) {\r\n\r\n\t\t\t\t\tvar words = tmptxt.split(' ');\r\n\r\n\t\t\t\t\tfor (var i=0; i<words.length; i++) {\r\n\r\n\t\t\t\t\t\tif (part.length + words[i].length +1 >CHARACTER_LIMIT)\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tpart += (i!=0?' ':'') + words[i];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tpart = tmptxt.substr(0, p+1);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttmptxt = tmptxt.substr(part.length, tmptxt.length-part.length);\r\n\r\n\t\t\t\tmultipartText.push(part);\r\n\t\t\t\t//console.log(part.length + \" - \" + part);\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//Add the remaining text\r\n\t\t\tif (tmptxt.length>0) {\r\n\t\t\t\tmultipartText.push(tmptxt);\r\n\t\t\t}\r\n\r\n\t\t}else{\r\n\r\n\t\t\t//Small text\r\n\t\t\tmultipartText.push(text);\r\n\t\t}\r\n\r\n\r\n\t\t//Find system voice that matches voice name\r\n\t\tvar rv;\r\n\r\n\t\tif (voicename==null) {\r\n\t\t\trv = self.default_rv;\r\n\t\t}else{\r\n\t\t\trv = getResponsiveVoice(voicename);\r\n\t\t}\r\n\r\n\t\tvar profile = {};\r\n\r\n\t\t//Map was done so no need to look for the mapped voice\r\n\t\tif (rv.mappedProfile!=null) {\r\n\r\n\t\t\tprofile = rv.mappedProfile;\r\n\r\n\t\t}else{\r\n\r\n\t\t\tprofile.systemvoice = getMatchedVoice(rv);\r\n\t\t\tprofile.collectionvoice = {};\r\n\r\n\t\t\tif (profile.systemvoice==null) {\r\n\t\t\t\tconsole.log('ERROR: No voice found for: ' + voicename);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tself.msgprofile = profile;\r\n\r\n\r\n\t\tif (profile.collectionvoice.fallbackvoice==true) {\r\n\t\t\tfallbackMode = true;\r\n\t\t\tself.fallback_parts = [];\r\n\t\t}else{\r\n\t\t\tfallbackMode = false;\r\n\t\t}\r\n\r\n\r\n\t\t//Play multipart text\r\n\t\tfor (var i=0; i<multipartText.length; i++) {\r\n\r\n\t\t\tif (!fallbackMode) {\r\n\t\t\t\t//Use SpeechSynthesis\r\n\r\n\t\t\t\t//Create msg object\r\n\t\t\t\tvar msg = new SpeechSynthesisUtterance();\r\n\t\t\t\tmsg.voice = profile.systemvoice;\r\n\t\t\t\tmsg.voiceURI = profile.systemvoice.voiceURI;\r\n\t\t\t\tmsg.volume = profile.collectionvoice.volume || profile.systemvoice.volume || 1; // 0 to 1\r\n\t\t\t\tmsg.rate = profile.collectionvoice.rate || profile.systemvoice.rate || 1; // 0.1 to 10\r\n\t\t\t\tmsg.pitch = profile.collectionvoice.pitch || profile.systemvoice.pitch || 1; //0 to 2*/\r\n\t\t\t\tmsg.text = multipartText[i];\r\n\t\t\t\tmsg.lang = profile.collectionvoice.lang || profile.systemvoice.lang;\r\n\t\t\t\t//console.log(msg);\r\n\r\n\t\t\t\tif (i == 0) {\r\n\t\t\t\t\tmsg.onstart = self.speech_onstart;\r\n\t\t\t\t}\r\n\t\t\t\tself.msgparameters.onendcalled = false;\r\n\r\n\t\t\t\tif (parameters != null) {\r\n\r\n\t\t\t\t\tif (i < multipartText.length - 1 && multipartText.length > 1) {\r\n\t\t\t\t\t\t// don't need this\r\n\t\t\t\t\t\t// msg.onend = self.onPartEnd;\r\n\t\t\t\t\t\t// if (msg.hasOwnProperty(\"addEventListener\"))\r\n\t\t\t\t\t\t// \tmsg.addEventListener('end',self.onPartEnd);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmsg.onend = self.speech_onend;\r\n\t\t\t\t\t\tif (msg.hasOwnProperty(\"addEventListener\"))\r\n\t\t\t\t\t\t\tmsg.addEventListener('end',self.speech_onend);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tmsg.onerror = parameters.onerror || function (e) {\r\n\t\t\t\t\t\t\tself.log('RV: Unknow Error');\r\n\t\t\t\t\t\t\tself.log(e);\r\n\t\t\t\t\t\t};\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.log('No Params received for current Utterance');\r\n\r\n\t\t\t\t\tmsg.onend = self.speech_onend;\r\n\t\t\t\t\tmsg.onerror = function (e) {\r\n\t\t\t\t\t\tself.log('RV: Unknow Error');\r\n\t\t\t\t\t\tself.log(e);\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\r\n\t\t\t\tself.cancelled = false;\r\n\t\t\t\tspeechSynthesis.speak(msg);\r\n\r\n\t\t\t}else{\r\n\r\n\t\t\t\tvar url = 'http://www.corsproxy.com/translate.google.com/translate_tts?ie=UTF-8&q=' + multipartText[i] + '&tl=' + profile.collectionvoice.lang || profile.systemvoice.lang || 'en-US';\r\n\r\n\t\t\t\tvar audio = new Audio(url);\r\n\t\t\t\taudio.playbackRate = 1;\r\n\t\t\t\taudio.preload = 'auto';\r\n\t\t\t\taudio.volume = profile.collectionvoice.volume || profile.systemvoice.volume || 1; // 0 to 1;\r\n\t\t\t\tself.fallback_parts.push(audio);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (fallbackMode)\r\n\t\t\tself.fallback_startPlaying();\r\n\r\n\t}\r\n\r\n\tthis.fallback_startPlaying = function() {\r\n\r\n\t\t//console.log('start playing');\r\n\r\n\t\tself.fallback_part_index = 0;\r\n\r\n\t\t//console.log(self.fallback_parts);\r\n\r\n\t\tself.fallback_finishedplaying();\r\n\r\n\r\n\r\n\t}\r\n\r\n\tthis.fallback_finishedplaying = function(e) {\r\n\t\t//console.log('chunk ended');\r\n\t\tself.fallback_audio = self.fallback_parts[self.fallback_part_index];\r\n\t\t//console.log(self.fallback_audio);\r\n\r\n\r\n\r\n\t\t//self.fallback_audio.addEventListener('error', function(e){ console.log('error'); console.log(e)});\r\n\t\t//self.fallback_audio.addEventListener('progress', function(e){ console.log('progress'); this.play();});\r\n\t\t//self.fallback_audio.addEventListener('loadstart', function(e){ console.log('loadstart'); console.log(e)});\r\n\t\t//self.fallback_audio.load();\r\n\t\tself.fallback_audio.play();\r\n\r\n\t\t//audio.addEventListener('play', utterance.onstart);\r\n\r\n\t\tself.fallback_part_index ++;\r\n\r\n\t\tif (self.fallback_part_index < self.fallback_parts.length) {\r\n\r\n\t\t\tself.fallback_audio.addEventListener('ended', self.fallback_finishedplaying);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.cancel = function() {\r\n\t\tself.checkAndCancelTimeout();\r\n\r\n\t\tif (fallbackMode)\r\n\t\t\tself.fallback_audio.pause();\r\n\t\telse\r\n\t\t\tself.cancelled = true;\r\n\t\t\tspeechSynthesis.cancel();\r\n\t}\r\n\r\n\r\n\tthis.voiceSupport = function() {\r\n\r\n\t\treturn ('speechSynthesis' in window);\r\n\r\n\t}\r\n\r\n\tself.numToWords = function (n) {\r\n\t\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\r\n\r\n\t\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\r\n\r\n\t\tvar arr = function arr(x) {\r\n\t\t\t\treturn Array.from(x);\r\n\t\t};\r\n\r\n\t\tvar num = function num(x) {\r\n\t\t\t\treturn Number(x) || 0;\r\n\t\t};\r\n\r\n\t\tvar isEmpty = function isEmpty(xs) {\r\n\t\t\t\treturn xs.length === 0;\r\n\t\t};\r\n\r\n\t\tvar take = function take(n) {\r\n\t\t\t\treturn function (xs) {\r\n\t\t\t\t\t\treturn xs.slice(0, n);\r\n\t\t\t\t};\r\n\t\t};\r\n\r\n\t\tvar drop = function drop(n) {\r\n\t\t\t\treturn function (xs) {\r\n\t\t\t\t\t\treturn xs.slice(n);\r\n\t\t\t\t};\r\n\t\t};\r\n\r\n\t\tvar reverse = function reverse(xs) {\r\n\t\t\t\treturn xs.slice(0).reverse();\r\n\t\t};\r\n\r\n\t\tvar comp = function comp(f) {\r\n\t\t\t\treturn function (g) {\r\n\t\t\t\t\t\treturn function (x) {\r\n\t\t\t\t\t\t\t\treturn f(g(x));\r\n\t\t\t\t\t\t};\r\n\t\t\t\t};\r\n\t\t};\r\n\r\n\t\tvar not = function not(x) {\r\n\t\t\t\treturn !x;\r\n\t\t};\r\n\r\n\t\tvar chunk = function chunk(n) {\r\n\t\t\t\treturn function (xs) {\r\n\t\t\t\t\t\treturn isEmpty(xs) ? [] : [take(n)(xs)].concat(_toConsumableArray(chunk(n)(drop(n)(xs))));\r\n\t\t\t\t};\r\n\t\t};\r\n\r\n\t\tvar a = ['', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen', 'sixteen', 'seventeen', 'eighteen', 'nineteen'];\r\n\r\n\t\tvar b = ['', '', 'twenty', 'thirty', 'forty', 'fifty', 'sixty', 'seventy', 'eighty', 'ninety'];\r\n\r\n\t\tvar g = ['', 'thousand', 'million', 'billion', 'trillion', 'quadrillion', 'quintillion', 'sextillion', 'septillion', 'octillion', 'nonillion'];\r\n\r\n\t\t// this part is really nasty still\r\n\t\t// it might edit this again later to show how Monoids could fix this up\r\n\t\tvar makeGroup = function makeGroup(_ref) {\r\n\t\t\t\tvar _ref2 = _slicedToArray(_ref, 3);\r\n\r\n\t\t\t\tvar ones = _ref2[0];\r\n\t\t\t\tvar tens = _ref2[1];\r\n\t\t\t\tvar huns = _ref2[2];\r\n\r\n\t\t\t\treturn [num(huns) === 0 ? '' : a[huns] + ' hundred ', num(ones) === 0 ? b[tens] : b[tens] && b[tens] + ' ' || '', a[tens + ones] || a[ones]].join('');\r\n\t\t};\r\n\r\n\t\tvar thousand = function thousand(group, i) {\r\n\t\t\t\treturn group === '' ? group : group + ' ' + g[i];\r\n\t\t};\r\n\r\n\t\tif (typeof n === 'number') return self.numToWords(String(n));else if (n === '0') return 'zero';else return comp(chunk(3))(reverse)(arr(n)).map(makeGroup).map(thousand).filter(comp(not)(isEmpty)).reverse().join(' ').trim();\r\n\t};\r\n\r\n\tself.getWords = function (text) {\r\n\t\t\tvar words = text.split(/(\\s*[\\s,]\\s*|\\?|;|:|\\.|\\(|\\)|!)/),\r\n\t\t\t\t\tmatch;\r\n\r\n\t\t\twords = words.filter(function(str) {\r\n\t\t\t\t\treturn /[^\\s]/.test(str);\r\n\t\t\t});\r\n\r\n\t\t\t//find numbers, translate them to text, push as words\r\n\t\t\tfor (var i = 0; i < words.length; i++) {\r\n\t\t\t\t\tif ((match = words[i].toString().match(/\\d+/)) != null) {\r\n\t\t\t\t\t\t\twords.splice(i, 1);\r\n\t\t\t\t\t\t\tself.numToWords(+match[0]).split(/\\s+/).map(function (word){\r\n\t\t\t\t\t\t\t\t\twords.push(word);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn words;\r\n\t};\r\n\r\n\tself.getEstimatedTimeLength = function (text, multiplier) {\r\n\t\t\tvar words = self.getWords(text),\r\n\t\t\t\t\tcharsCount = 0,\r\n\t\t\t\t\tbase = fallbackMode ? 1300 : 700,\r\n\t\t\t\t\tmultiplier = multiplier || 1/*, minWordLengthInText = 0, maxWordLengthInText = 0*/;\r\n\r\n\t\t\twords.map(function (word, i){\r\n\t\t\t\t\tcharsCount += (word.toString().match(/[^ ]/igm) || word).length;\r\n\r\n\t\t\t\t\t /*self.log(minWordLengthInText, maxWordLengthInText);\r\n\t\t\t\t\t if (minWordLengthInText > 0 && minWordLengthInText > word.length) {\r\n\t\t\t\t\t minWordLengthInText = word.length;\r\n\t\t\t\t\t } else if (maxWordLengthInText > 0 && maxWordLengthInText < word.length) {\r\n\t\t\t\t\t maxWordLengthInText = word.length;\r\n\t\t\t\t\t } else if (minWordLengthInText == 0 && maxWordLengthInText == 0) {\r\n\t\t\t\t\t minWordLengthInText = maxWordLengthInText = word.length;\r\n\t\t\t\t\t }*/\r\n\t\t\t});\r\n\r\n\t\t\t//self.log(\"Words: [\" + words + \"], charsCount: \" + charsCount);\r\n\r\n\t\t\tvar wordsCount = words.length;\r\n\t\t\t//var avgWordLengthInText = (minWordLengthInText + maxWordLengthInText) / 2;\r\n\r\n\t\t\t//self.log(minWordLengthInText, maxWordLengthInText, avgWordLengthInText);\r\n\r\n\t\t\t//var wlf = (charsCount/wordsCount) / avgWordLengthInText * 5.1; //word length factor: 5.1 is the average word length in english.\r\n\r\n\t\t\tvar estimatedLength = multiplier * 1000 * (60 / self.WORDS_PER_MINUTE) * wordsCount /** wlf*/;\r\n\r\n\t\t\tif (wordsCount < 5) {\r\n\t\t\t\t\testimatedLength = multiplier * (base + charsCount * 50);\r\n\t\t\t}\r\n\r\n\t\t\tself.log(\"Estimated time length: \" + estimatedLength + \" ms, words: [\" + words + \"], charsCount: \" + charsCount);\r\n\r\n\t\t\treturn estimatedLength;\r\n\t};\r\n\r\n\tself.startTimeout = function (text, callback) {\r\n\t\t\t//if (self.iOS) {\r\n\t\t\t//   multiplier = 0.5;\r\n\t\t\t//}\r\n\t\t\tvar multiplier = self.msgprofile.collectionvoice.timerSpeed;\r\n\t\t\tif (self.msgprofile.collectionvoice.timerSpeed==null)\r\n\t\t\t\t\tmultiplier = 1;\r\n\r\n\t\t\t//self.log(self.msgprofile.collectionvoice.name);\r\n\t\t\tif (multiplier <=0)\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\tself.timeoutId = setTimeout(callback, self.getEstimatedTimeLength(text, multiplier));\r\n\t\t\t//console.log(self.getEstimatedTimeLength(text, multiplier),callback);\r\n\t\t\tself.log(\"Timeout ID: \" + self.timeoutId, text);\r\n\t}\r\n\r\n\tself.isPlaying = function() {\r\n\t\t\tif (self.fallbackMode) {\r\n\t\t\t\t\treturn  (self.fallback_audio!=null &&\r\n\t\t\t\t\t\t\t\t\t!self.fallback_audio.ended &&\r\n\t\t\t\t\t\t\t\t\t!self.fallback_audio.paused);\r\n\t\t\t}else{\r\n\t\t\t\t\treturn speechSynthesis.speaking;\r\n\t\t\t}\r\n\t}\r\n\r\n\tself.checkAndCancelTimeout = function () {\r\n\t\t\tif (self.timeoutId != null) {\r\n\t\t\t\t\t//self.log(\"Timeout \" + self.timeoutId + \" cancelled\");\r\n\t\t\t\t\tclearTimeout(self.timeoutId);\r\n\t\t\t\t\tself.timeoutId = null;\r\n\t\t\t}\r\n\t}\r\n\r\n\tself.speech_timedout = function() {\r\n\t\t\t//self.log(\"Speech cancelled: Timeout \" + self.timeoutId + \" ended\");\r\n\t\t\tself.cancel();\r\n\t\t\tself.cancelled = false;\r\n\t\t\t//if (!self.iOS) //On iOS, cancel calls msg.onend\r\n\t\t\t\t\tself.speech_onend();\r\n\r\n\t}\r\n\r\n\tself.speech_onstart = function () {\r\n\t\t\t//Start can be triggered after onboundary!\r\n\t\t\t//if (self.onstartFired) return\r\n\r\n\t\t\tself.onstartFired = true;\r\n\t\t\t//if (!self.iOS)\r\n\t\t\tself.log(\"Speech start\");\r\n\t\t\tif (!self.fallbackMode) {\r\n\t\t\t\tself.startTimeout(self.msgtext,self.speech_timedout);\r\n\t\t\t}\r\n\r\n\t\t\tself.msgparameters.onendcalled=false;\r\n\t\t\tif (self.msgparameters != null && self.msgparameters.onstart != null) {\r\n\t\t\t\t\tself.msgparameters.onstart();\r\n\t\t\t}\r\n\t}\r\n\r\n\tself.speech_onend = function () {\r\n\t\tself.checkAndCancelTimeout();\r\n\r\n\t\t//Avoid this being automatically called just after calling speechSynthesis.cancel\r\n\t\tif (self.cancelled === true) {\r\n\t\t\t\tself.cancelled = false;\r\n\t\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tself.log(\"on end fired\");\r\n\r\n\t\tif (self.msgparameters != null && self.msgparameters.onend != null && self.msgparameters.onendcalled!=true) {\r\n\t\t\tself.log(\"Speech on end called  -\" + self.msgtext);\r\n\t\t\tself.msgparameters.onendcalled=true;\r\n\t\t\tif (!self.isPlaying()) {\r\n\t\t\t\tself.msgparameters.onend();\r\n\t\t\t} else {\r\n\t\t\t\tconsole.log('still talking');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tthis.OnFinishedPlaying = function(event) {\r\n\t\t//console.log(parameters);\r\n\t\tif (self.msgparameters != null) {\r\n\t\t\tif (self.msgparameters.onend != null ) {\r\n\t\t\t\tself.msgparameters.onend();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t//Set default voice to use when no voice name is supplied to speak()\r\n\tthis.setDefaultVoice = function(voicename) {\r\n\r\n\t\tvar vr = getResponsiveVoice(voicename);\r\n\r\n\t\tif (vr!=null) {\r\n\t\t\tself.default_vr = vr;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//Map responsivevoices to system voices\r\n\tfunction mapRVs() {\r\n\r\n\t\tfor (var i=0; i<responsivevoices.length; i++) {\r\n\r\n\t\t\tvar rv = responsivevoices[i];\r\n\r\n\t\t\tfor (var j=0; j<rv.voiceIDs.length; j++) {\r\n\r\n\t\t\t\tvar vcoll = voicecollection[rv.voiceIDs[j]];\r\n\r\n\t\t\t\tif (vcoll.fallbackvoice != true) {\t\t// vcoll.fallbackvoice would be null instead of false\r\n\r\n\t\t\t\t\t// Look on system voices\r\n\t\t\t\t\tvar v = getSystemVoice(vcoll.name);\r\n\t\t\t\t\tif (v!=null) {\r\n\t\t\t\t\t\trv.mappedProfile = {\r\n\t\t\t\t\t\t\tsystemvoice: v,\r\n\t\t\t\t\t\t\tcollectionvoice: vcoll\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tconsole.log(\"Mapped \" + rv.name + \" to \" + v.name);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}else {\r\n\r\n\t\t\t\t\t//Pick the fallback voice\r\n\t\t\t\t\trv.mappedProfile = {\r\n\t\t\t\t\t\tsystemvoice: {},\r\n\t\t\t\t\t\tcollectionvoice: vcoll\r\n\t\t\t\t\t};\r\n\t\t\t\t\tconsole.log(\"Mapped \" + rv.name + \" to \" + vcoll.lang + \" fallback voice\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t}\r\n\r\n\r\n\t//Look for the voice in the system that matches the one in our collection\r\n\tfunction getMatchedVoice(rv) {\r\n\r\n\t\tfor (var i=0; i<rv.voiceIDs.length; i++) {\r\n\t\t\tvar v = getSystemVoice(voicecollection[rv.voiceIDs[i]].name);\r\n\t\t\tif (v!=null)\r\n\t\t\t\treturn v;\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n\tfunction getSystemVoice(name) {\r\n\r\n\t\tif (typeof systemvoices === 'undefined') return null;\r\n\r\n\t\tfor (var i=0; i<systemvoices.length; i++) {\r\n\t\t\tif (systemvoices[i].name == name)\r\n\t\t\t\treturn systemvoices[i];\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n\tfunction getResponsiveVoice(name) {\r\n\r\n\t\tfor (var i=0; i<responsivevoices.length; i++) {\r\n\t\t\tif (responsivevoices[i].name == name) {\r\n\t\t\t\treturn responsivevoices[i];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n}\r\n)();\r\n\r\nmodule.exports = responsiveVoice;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}